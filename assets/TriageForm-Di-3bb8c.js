import{j as e,A as N,T as S,L as b}from"./index-Ho7Cjgmc.js";import{r as g}from"./vendor-Gm9i_4Ku.js";import{s as C}from"./triageService-CxCohCPW.js";import{u as w}from"./router-DR174eU1.js";import"./ui-F4NiDqF7.js";const k=({symptom:c,onClick:m})=>{const{name:d,severity:i,selected:r,description:l}=c,o=(t=>{switch(t==null?void 0:t.toLowerCase()){case"low":return{color:"#28a745",icon:"⚠️",label:"Low"};case"medium":return{color:"#ffc107",icon:"❗",label:"Medium"};case"high":return{color:"#dc3545",icon:"🚨",label:"High"};default:return{color:"#6c757d",icon:"●",label:"Unknown"}}})(i),n=()=>{m&&m(c)},y=t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),n())};return e.jsxs("div",{className:`symptom-card ${r?"selected":""}`,onClick:n,onKeyPress:y,role:"button",tabIndex:0,"aria-pressed":r,"aria-label":`${d} symptom, ${o.label} severity${r?", selected":""}`,children:[e.jsxs("div",{className:"symptom-card-header",children:[e.jsxs("div",{className:"symptom-info",children:[e.jsx("h3",{className:"symptom-name",children:d}),e.jsxs("div",{className:"severity-indicator",style:{"--severity-color":o.color},children:[e.jsx("span",{className:"severity-icon",children:o.icon}),e.jsx("span",{className:"severity-label",children:o.label})]})]}),e.jsx("div",{className:"selection-indicator",children:r&&e.jsx("div",{className:"check-mark",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20,6 9,17 4,12"})})})})]}),l&&e.jsx("div",{className:"symptom-description",children:e.jsx("p",{children:l})}),e.jsx("div",{className:"symptom-card-footer",children:e.jsx("span",{className:"interaction-hint",children:r?"Selected":"Click to select"})})]})},P=[{id:1,name:"Chest Pain",description:"Pain or discomfort in the chest area",severity:"high",category:"cardiac"},{id:2,name:"Shortness of Breath",description:"Difficulty breathing or feeling out of breath",severity:"high",category:"respiratory"},{id:3,name:"Fever",description:"Body temperature above normal (100.4°F/38°C)",severity:"medium",category:"general"},{id:4,name:"Headache",description:"Pain in the head or neck area",severity:"low",category:"neurological"},{id:5,name:"Nausea/Vomiting",description:"Feeling sick to stomach or vomiting",severity:"medium",category:"gastrointestinal"},{id:6,name:"Dizziness",description:"Feeling lightheaded or unsteady",severity:"medium",category:"neurological"},{id:7,name:"Abdominal Pain",description:"Pain in the stomach or abdominal area",severity:"medium",category:"gastrointestinal"},{id:8,name:"Fatigue",description:"Extreme tiredness or exhaustion",severity:"low",category:"general"},{id:9,name:"Cough",description:"Persistent coughing",severity:"low",category:"respiratory"},{id:10,name:"Skin Rash",description:"Unusual skin changes or irritation",severity:"low",category:"dermatological"},{id:11,name:"Joint Pain",description:"Pain in joints or muscles",severity:"low",category:"musculoskeletal"},{id:12,name:"Difficulty Swallowing",description:"Problems swallowing food or liquids",severity:"medium",category:"gastrointestinal"}],I=()=>{const c=w(),{user:m,loading:d}=g.useContext(N),{selectedSymptoms:i,setSelectedSymptoms:r}=g.useContext(S),[l,p]=g.useState(!1),[o,n]=g.useState(null),[y,t]=g.useState(0);g.useEffect(()=>{!d&&!m&&c(`/triage/results/${response._id}`,{state:{result:response}})},[m,d,c]);const x=s=>{r(a=>a.some(u=>u.id===s.id)?a.filter(u=>u.id!==s.id):[...a,s])},j=()=>{r([])},v=async s=>{if(s.preventDefault(),i.length===0){n("Please select at least one symptom to continue.");return}p(!0),n(null),t(0);try{const a=setInterval(()=>{t(u=>u>=90?(clearInterval(a),90):u+10)},100);console.log("Selected symptoms:",i);const h=await C(i);console.log("Triage submission response:",h),clearInterval(a),t(100),setTimeout(()=>{h&&h._id?c(`/triage/results/${h._id}`,{state:{result:h}}):n("Could not retrieve assessment result. Please try again.")},500)}catch(a){p(!1),t(0),n(a.message||"An error occurred while submitting your assessment. Please try again.")}},f=()=>{n(null),v({preventDefault:()=>{}})};return d?e.jsx("div",{className:"triage-form-container",children:e.jsxs("div",{className:"auth-loading",children:[e.jsx(b,{}),e.jsx("p",{children:"Verifying authentication..."})]})}):m?e.jsxs("div",{className:"triage-form-container",children:[e.jsxs("header",{className:"triage-header",children:[e.jsx("h1",{children:"Health Assessment"}),e.jsx("p",{className:"triage-subtitle",children:"Select all symptoms you are currently experiencing. This will help us provide you with appropriate care recommendations."})]}),e.jsxs("form",{onSubmit:v,className:"triage-form",noValidate:!0,children:[e.jsxs("section",{className:"symptoms-section","aria-labelledby":"symptoms-heading",children:[e.jsx("h2",{id:"symptoms-heading",children:"Select Your Symptoms"}),e.jsx("div",{className:"symptoms-grid",role:"group","aria-labelledby":"symptoms-heading",children:P.map(s=>e.jsx(k,{symptom:{...s,selected:i.some(a=>a.id===s.id)},onClick:x},s.id))})]}),i.length>0&&e.jsxs("section",{className:"summary-section","aria-labelledby":"summary-heading",children:[e.jsxs("div",{className:"summary-header",children:[e.jsxs("h3",{id:"summary-heading",children:["Selected Symptoms (",i.length,")"]}),e.jsx("button",{type:"button",onClick:j,className:"clear-all-btn","aria-label":"Clear all selected symptoms",children:"Clear All"})]}),e.jsx("div",{className:"selected-symptoms-list",role:"list",children:i.map(s=>e.jsxs("div",{className:"selected-symptom-item",role:"listitem",children:[e.jsx("span",{className:"symptom-name",children:s.name}),e.jsx("span",{className:`severity-badge severity-${s.severity}`,children:s.severity}),e.jsx("button",{type:"button",onClick:()=>x(s),className:"remove-symptom-btn","aria-label":`Remove ${s.name} from selection`,children:"×"})]},s.id))})]}),o&&e.jsxs("div",{className:"error-section",role:"alert","aria-live":"polite",children:[e.jsxs("div",{className:"error-message",children:[e.jsx("span",{className:"error-icon",children:"⚠"}),e.jsx("span",{className:"error-text",children:o})]}),e.jsx("button",{type:"button",onClick:f,className:"retry-btn",disabled:l,children:"Try Again"})]}),l&&e.jsxs("div",{className:"progress-section","aria-live":"polite",children:[e.jsx("div",{className:"progress-bar-container",children:e.jsx("div",{className:"progress-bar",style:{width:`${y}%`},role:"progressbar","aria-valuenow":y,"aria-valuemin":"0","aria-valuemax":"100","aria-label":"Assessment submission progress"})}),e.jsx("p",{className:"progress-text",children:"Submitting your assessment..."})]}),e.jsxs("div",{className:"submit-section",children:[e.jsx("button",{type:"submit",className:"submit-btn",disabled:l||i.length===0,"aria-describedby":i.length===0?"submit-help":void 0,children:l?e.jsxs(e.Fragment,{children:[e.jsx(b,{size:"small"}),e.jsx("span",{children:"Submitting Assessment..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submit Assessment"}),e.jsx("span",{className:"submit-icon",children:"→"})]})}),i.length===0&&e.jsx("p",{id:"submit-help",className:"submit-help-text",children:"Please select at least one symptom to continue"})]})]}),e.jsx("div",{className:"emergency-notice",role:"complementary",children:e.jsxs("div",{className:"emergency-content",children:[e.jsx("span",{className:"emergency-icon",children:"🚨"}),e.jsxs("div",{className:"emergency-text",children:[e.jsx("strong",{children:"Emergency?"})," If you are experiencing a medical emergency, call 911 or go to your nearest emergency room immediately."]})]})})]}):null};export{I as default};
