// Updated: 2025-12-19 13:14:52 - perf: fix ui dashboard
// Updated: 2025-12-19 13:14:46 - docs(patient): enhance API endpoints in patient
// Updated: 2025-12-19 13:14:40 - chore(auth): refactor auth patient form
// Updated: 2025-12-19 13:14:40 - style(ui): refactor triage system
// Updated: 2025-12-19 13:14:33 - docs(database): improve database API endpoints
// Updated: 2025-12-19 13:14:33 - chore(auth): add triage system in auth
// Updated: 2025-12-19 13:14:25 - style: refactor ui dashboard
// Updated: 2025-12-19 13:14:08 - docs(socket): implement error handling in socket
// Updated: 2025-12-19 13:13:58 - style: refactor validation database schema
// Updated: 2025-12-19 12:28:14 - style(auth): fix auth triage system
// Updated: 2025-12-19 12:28:11 - chore: improve auth authentication
// Updated: 2025-12-19 12:28:06 - feat(patient): refactor patient form in patient
// Updated: 2025-12-19 12:28:03 - fix(api): add api database schema
// Updated: 2025-12-19 12:28:01 - perf(api): improve triage system
// Updated: 2025-12-19 12:27:57 - style: add validation database schema
// Updated: 2025-12-19 12:27:55 - fix(auth): implement auth error handling
// Updated: 2025-12-19 12:27:49 - perf(api): add API endpoints in api
// Updated: 2025-12-19 12:27:30 - style(ui): implement ui patient form
// Updated: 2025-12-19 12:26:56 - docs(api): enhance patient form in api
// Updated: 2025-12-19 12:26:48 - chore(auth): enhance error handling (fixes #49)
// Updated: 2025-12-19 12:26:48 - docs(triage): improve triage API endpoints
// Updated: 2025-12-19 12:26:46 - perf(ui): optimize database schema
// Updated: 2025-12-19 12:26:43 - test(socket): improve UI components
// Updated: 2025-12-19 12:26:33 - style(ui): update triage system in ui
// Updated: 2025-12-19 12:26:29 - fix(database): refactor authentication
// Updated: 2025-12-19 12:26:26 - perf(validation): optimize validation API endpoints (fixes #32)
// Updated: 2025-12-19 12:26:24 - style(api): update api error handling (fixes #8)
// Updated: 2025-12-19 12:26:23 - docs(validation): fix authentication in validation
// Updated: 2025-12-19 12:26:22 - chore(api): enhance database schema in api
// Updated: 2025-12-19 12:25:47 - fix(socket): fix authentication in socket
// Updated: 2025-12-19 12:25:44 - docs(socket): refactor socket database schema
// Updated: 2025-12-19 12:25:39 - fix: improve ui database schema
// Updated: 2025-12-19 12:25:38 - style: fix socket authentication
// Updated: 2025-12-19 12:25:31 - fix(triage): add triage authentication
// Updated: 2025-12-19 12:25:16 - test(api): implement database schema in api (fixes #25)
// Updated: 2025-12-19 12:25:16 - feat(socket): implement dashboard (fixes #26)
// Updated: 2025-12-19 12:25:11 - perf: fix validation API endpoints
// Updated: 2025-12-19 12:25:01 - test(auth): implement auth authentication
// Updated: 2025-12-19 12:24:59 - style: implement socket triage system
// Updated: 2025-12-19 12:23:05 - perf: add patient triage system
// Updated: 2025-12-19 12:22:55 - feat(validation): add validation patient form
// Updated: 2025-12-19 12:22:53 - test: improve triage API endpoints
// Updated: 2025-12-19 12:22:51 - test(triage): refactor triage triage system
// Updated: 2025-12-19 12:22:47 - test(validation): update error handling in validation
// Updated: 2025-12-19 12:22:38 - refactor: optimize patient error handling
// Updated: 2025-12-19 12:22:23 - feat(socket): refactor socket error handling (fixes #19)
// Updated: 2025-12-19 12:22:03 - style(auth): fix auth error handling
// Updated: 2025-12-19 12:21:58 - feat: optimize validation error handling
// Updated: 2025-12-19 12:21:55 - style(auth): implement auth dashboard
// Updated: 2025-12-19 12:21:54 - feat(validation): refactor dashboard
// Updated: 2025-12-19 12:21:52 - test(triage): fix database schema
// Updated: 2025-12-19 12:21:49 - feat(patient): add error handling (fixes #19)
// Updated: 2025-12-19 12:21:27 - chore(database): optimize dashboard
// Updated: 2025-12-19 12:21:25 - refactor(ui): enhance dashboard in ui
// Updated: 2025-12-19 12:21:18 - perf: improve socket API endpoints
// Updated: 2025-12-19 12:21:15 - refactor(api): fix api database schema
// Updated: 2025-12-19 12:21:03 - test(ui): improve error handling (fixes #34)
// Updated: 2025-12-19 12:20:57 - fix(triage): add dashboard
// Updated: 2025-12-19 12:20:52 - style(triage): improve UI components
// Updated: 2025-12-19 12:20:50 - perf: update triage API endpoints
// Updated: 2025-12-19 12:20:41 - perf(ui): refactor patient form (fixes #37)
// Updated: 2025-12-19 12:20:40 - chore(socket): improve patient form in socket
// Updated: 2025-12-19 12:20:37 - perf(ui): enhance database schema in ui
// Updated: 2025-12-19 12:20:33 - refactor(database): enhance triage system
// Updated: 2025-12-19 12:20:27 - feat(patient): improve patient patient form
// Updated: 2025-12-19 12:20:21 - refactor(socket): optimize API endpoints
// Updated: 2025-12-19 12:20:20 - refactor: enhance database error handling
// Updated: 2025-12-19 12:20:19 - perf(database): add database schema
// Updated: 2025-12-19 12:20:14 - chore(ui): fix triage system in ui
// Updated: 2025-12-19 12:20:10 - style(socket): optimize dashboard
// Updated: 2025-12-19 12:20:07 - chore(database): enhance database API endpoints
// Updated: 2025-12-19 12:19:49 - perf(api): optimize patient form in api
// Updated: 2025-12-19 12:19:48 - refactor: fix socket patient form
// Updated: 2025-12-19 12:19:45 - test(auth): update patient form
// Updated: 2025-12-19 12:19:24 - fix(database): refactor error handling
// Updated: 2025-12-19 12:19:23 - style(patient): implement database schema
// Updated: 2025-12-19 12:19:22 - test(triage): fix error handling
// Updated: 2025-12-19 12:19:21 - chore(auth): enhance auth database schema (fixes #24)
// Updated: 2025-12-19 12:19:16 - docs: update socket authentication
// Updated: 2025-12-19 12:19:10 - chore(validation): add validation dashboard
// Updated: 2025-12-19 12:19:06 - fix: enhance socket dashboard (fixes #10)
// Updated: 2025-12-19 12:19:03 - refactor(validation): update validation error handling
// Updated: 2025-12-19 12:19:02 - fix(database): improve UI components in database
// Updated: 2025-12-19 12:18:48 - refactor(api): add api UI components
// Updated: 2025-12-19 12:18:36 - perf: implement database error handling (fixes #25)
// Updated: 2025-12-19 12:18:24 - chore(auth): fix auth error handling (fixes #28)
// Updated: 2025-12-19 12:18:16 - perf(api): fix api dashboard
// Updated: 2025-12-19 12:18:11 - test: add auth patient form
// Updated: 2025-12-19 12:18:08 - style(socket): update socket triage system
// Updated: 2025-12-19 12:18:01 - docs: enhance triage error handling
// Updated: 2025-12-19 12:17:47 - style(patient): add patient form in patient (fixes #13)
// Updated: 2025-12-19 12:17:40 - docs: implement database dashboard
// Updated: 2025-12-19 12:07:25 - feat: fix auth patient form
// Updated: 2025-12-19 12:07:22 - chore: update auth triage system (fixes #1)
// Updated: 2025-12-19 12:06:54 - feat(socket): implement error handling (fixes #42)
// Updated: 2025-12-19 12:06:29 - refactor(triage): implement triage dashboard
// Updated: 2025-12-19 12:06:27 - style: enhance auth patient form (fixes #18)
// Updated: 2025-12-19 12:06:16 - refactor: fix triage error handling
// Updated: 2025-12-19 12:05:58 - test(database): fix database triage system
// Updated: 2025-12-19 12:05:56 - feat(validation): implement patient form in validation
// Updated: 2025-12-19 12:05:26 - test(auth): update API endpoints
// Updated: 2025-12-19 12:05:09 - fix: optimize auth error handling
// Updated: 2025-12-19 12:04:55 - perf: add auth patient form (fixes #7)
// Updated: 2025-12-19 12:04:52 - refactor(triage): improve triage patient form
// Updated: 2025-12-19 12:04:50 - docs(database): add API endpoints in database
// Updated: 2025-12-19 12:04:49 - fix(patient): implement API endpoints in patient
// Updated: 2025-12-19 12:04:42 - feat(validation): add API endpoints
// Updated: 2025-12-19 12:04:33 - docs(ui): refactor ui UI components
// Updated: 2025-12-19 12:04:07 - refactor(auth): enhance auth patient form
// Updated: 2025-12-19 12:04:06 - perf(auth): add dashboard in auth (fixes #5)
// Updated: 2025-12-19 12:03:53 - fix(triage): refactor triage UI components (fixes #30)
// Updated: 2025-12-19 12:03:37 - docs(validation): fix API endpoints in validation
// Updated: 2025-12-19 12:03:29 - docs(ui): add error handling
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import { getTriageHistory } from '../services/triageService';
import './Dashboard.css';

const Dashboard = () => {
  const { user } = useAuth();
  const navigate = useNavigate();
  const [recentTriage, setRecentTriage] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    const fetchRecentTriage = async () => {
      try {
        setLoading(true);
        setError(null);
        
        const history = await getTriageHistory();
        
        // Get the most recent triage if available
        if (history && history.length > 0) {
          setRecentTriage(history[0]);
        }
      } catch (err) {
        console.error('Error fetching recent triage:', err);
        setError('Failed to load recent triage data');
      } finally {
        setLoading(false);
      }
    };

    fetchRecentTriage();
  }, []);

  const handleStartNewTriage = () => {
    navigate('/triage');
  };

  const handleViewHistory = () => {
    navigate('/history');
  };

  const formatDate = (dateString) => {
    return new Date(dateString).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const getPriorityColor = (priority) => {
    switch (priority?.toLowerCase()) {
      case 'high':
        return '#dc3545';
      case 'medium':
        return '#fd7e14';
      case 'low':
        return '#198754';
      default:
        return '#6c757d';
    }
  };

  const getPriorityIcon = (priority) => {
    switch (priority?.toLowerCase()) {
      case 'high':
        return 'ðŸ”´';
      case 'medium':
        return 'ðŸŸ¡';
      case 'low':
        return 'ðŸŸ¢';
      default:
        return 'âšª';
    }
  };

  if (loading) {
    return (
      <div className="dashboard-container">
        <div className="dashboard-loader">
          <div className="loader-spinner"></div>
          <p>Loading your dashboard...</p>
        </div>
      </div>
    );
  }

  return (
    <div className="dashboard-container">
      <div className="dashboard-content">
        {/* Welcome Section */}
        <div className="welcome-section">
          <h1 className="welcome-title">
            Welcome back, {user?.name || 'User'}!
          </h1>
          <p className="welcome-subtitle">
            Your health assessment dashboard is ready to help you make informed decisions about your care.
          </p>
        </div>

        {/* Quick Actions */}
        <div className="quick-actions">
          <div className="action-card primary-action">
            <div className="action-icon">ðŸ¥</div>
            <h3>Start New Assessment</h3>
            <p>Begin a new health emergency assessment to get personalized care recommendations.</p>
            <button 
              className="action-button primary"
              onClick={handleStartNewTriage}
            >
              Start New Assessment
            </button>
          </div>

          <div className="action-card secondary-action">
            <div className="action-icon">ðŸ“‹</div>
            <h3>View History</h3>
            <p>Review your previous assessments and track your health journey over time.</p>
            <button 
              className="action-button secondary"
              onClick={handleViewHistory}
            >
              View Full History
            </button>
          </div>
        </div>

        {/* Recent Assessment Summary */}
        <div className="recent-triage-section">
          <h2>Recent Assessment</h2>
          
          {error && (
            <div className="error-message">
              <span className="error-icon">âš ï¸</span>
              {error}
            </div>
          )}

          {!error && recentTriage ? (
            <div className="recent-triage-card">
              <div className="triage-header">
                <div className="triage-priority">
                  <span className="priority-icon">
                    {getPriorityIcon(recentTriage.priority)}
                  </span>
                  <span 
                    className="priority-text"
                    style={{ color: getPriorityColor(recentTriage.priority) }}
                  >
                    {recentTriage.priority} Priority
                  </span>
                </div>
                <div className="triage-date">
                  {formatDate(recentTriage.createdAt)}
                </div>
              </div>
              
              <div className="triage-content">
                <div className="triage-symptoms">
                  <h4>Symptoms Reported:</h4>
                  <div className="symptoms-list">
                    {recentTriage.symptoms?.map((symptom, index) => (
                      <span key={index} className="symptom-tag">
                        {symptom}
                      </span>
                    ))}
                  </div>
                </div>
                
                <div className="triage-recommendation">
                  <h4>Recommendation:</h4>
                  <p>{recentTriage.recommendation}</p>
                </div>
              </div>
              
              <div className="triage-actions">
                <button 
                  className="view-details-btn"
                  onClick={handleViewHistory}
                >
                  View Details
                </button>
              </div>
            </div>
          ) : !error && (
            <div className="no-triage-card">
              <div className="no-triage-icon">ðŸ”</div>
              <h3>No Previous Assessments</h3>
              <p>You haven't completed any health assessments yet. Start your first emergency assessment to get personalized care recommendations.</p>
              <button 
                className="action-button primary"
                onClick={handleStartNewTriage}
              >
                Start Your First Assessment
              </button>
            </div>
          )}
        </div>

        {/* Health Tips */}
        <div className="health-tips-section">
          <h2>Health Tips</h2>
          <div className="tips-grid">
            <div className="tip-card">
              <div className="tip-icon">ðŸ’§</div>
              <h4>Stay Hydrated</h4>
              <p>Drink at least 8 glasses of water daily to maintain optimal health.</p>
            </div>
            <div className="tip-card">
              <div className="tip-icon">ðŸš¶</div>
              <h4>Regular Exercise</h4>
              <p>Aim for 30 minutes of moderate exercise most days of the week.</p>
            </div>
            <div className="tip-card">
              <div className="tip-icon">ðŸ˜´</div>
              <h4>Quality Sleep</h4>
              <p>Get 7-9 hours of quality sleep each night for better health.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default Dashboard;
















































































































