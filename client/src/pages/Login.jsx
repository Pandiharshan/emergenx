// Updated: 2025-12-19 13:14:05 - perf(ui): optimize triage system
// Updated: 2025-12-19 13:14:02 - chore(triage): fix dashboard in triage
// Updated: 2025-12-19 12:28:14 - feat(socket): optimize triage system
// Updated: 2025-12-19 12:28:06 - fix(auth): improve auth authentication
// Updated: 2025-12-19 12:27:51 - perf(auth): implement triage system
// Updated: 2025-12-19 12:27:47 - test(validation): improve triage system in validation
// Updated: 2025-12-19 12:27:35 - chore(api): improve authentication
// Updated: 2025-12-19 12:27:30 - feat(validation): fix patient form
// Updated: 2025-12-19 12:27:17 - chore: add auth database schema
// Updated: 2025-12-19 12:27:05 - style(socket): optimize database schema
// Updated: 2025-12-19 12:26:54 - docs(validation): improve validation UI components
// Updated: 2025-12-19 12:26:45 - feat: update database API endpoints
// Updated: 2025-12-19 12:26:40 - docs(triage): fix triage system in triage (fixes #1)
// Updated: 2025-12-19 12:26:21 - perf(database): enhance database schema in database
// Updated: 2025-12-19 12:26:20 - style(socket): add UI components
// Updated: 2025-12-19 12:26:12 - perf(socket): add triage system in socket
// Updated: 2025-12-19 12:26:10 - docs(triage): add database schema in triage (fixes #38)
// Updated: 2025-12-19 12:26:08 - perf(validation): improve triage system in validation (fixes #21)
// Updated: 2025-12-19 12:26:02 - refactor: enhance api dashboard
// Updated: 2025-12-19 12:25:58 - test(auth): enhance error handling
// Updated: 2025-12-19 12:25:54 - test(ui): update triage system
// Updated: 2025-12-19 12:25:30 - style(triage): fix authentication in triage
// Updated: 2025-12-19 12:25:29 - refactor(api): update error handling in api
// Updated: 2025-12-19 12:25:21 - feat(database): implement database database schema
// Updated: 2025-12-19 12:25:15 - style(triage): enhance database schema
// Updated: 2025-12-19 12:25:13 - chore(validation): improve API endpoints in validation
// Updated: 2025-12-19 12:25:05 - test(validation): refactor validation API endpoints
// Updated: 2025-12-19 12:25:04 - fix(database): add database database schema
// Updated: 2025-12-19 12:23:23 - fix: optimize socket dashboard (fixes #37)
// Updated: 2025-12-19 12:23:07 - chore(socket): refactor error handling in socket
// Updated: 2025-12-19 12:23:06 - fix(socket): fix triage system (fixes #17)
// Updated: 2025-12-19 12:22:51 - docs: update triage dashboard
// Updated: 2025-12-19 12:22:39 - docs(ui): improve UI components in ui
// Updated: 2025-12-19 12:22:35 - fix(validation): optimize patient form in validation
// Updated: 2025-12-19 12:22:33 - refactor(socket): enhance triage system in socket (fixes #11)
// Updated: 2025-12-19 12:22:30 - docs(ui): implement database schema in ui
// Updated: 2025-12-19 12:22:29 - chore(triage): refactor triage system
// Updated: 2025-12-19 12:22:27 - test(auth): update auth patient form
// Updated: 2025-12-19 12:22:21 - refactor: optimize validation database schema
// Updated: 2025-12-19 12:22:15 - chore: add triage API endpoints
// Updated: 2025-12-19 12:22:13 - refactor: update api API endpoints
// Updated: 2025-12-19 12:22:09 - fix(database): fix database schema
// Updated: 2025-12-19 12:21:59 - chore: fix validation dashboard
// Updated: 2025-12-19 12:21:59 - perf(api): refactor api UI components
// Updated: 2025-12-19 12:21:44 - test: refactor api triage system
// Updated: 2025-12-19 12:21:11 - test(socket): update patient form in socket
// Updated: 2025-12-19 12:21:02 - docs(ui): refactor database schema
// Updated: 2025-12-19 12:21:00 - fix(triage): refactor API endpoints
// Updated: 2025-12-19 12:20:56 - test(validation): optimize validation patient form
// Updated: 2025-12-19 12:20:47 - fix: enhance validation API endpoints
// Updated: 2025-12-19 12:20:37 - test(ui): implement ui UI components
// Updated: 2025-12-19 12:20:33 - test(database): improve database schema in database (fixes #34)
// Updated: 2025-12-19 12:20:24 - test(database): fix database error handling (fixes #43)
// Updated: 2025-12-19 12:20:15 - perf(patient): implement patient error handling (fixes #10)
// Updated: 2025-12-19 12:20:08 - test(socket): enhance socket authentication (fixes #13)
// Updated: 2025-12-19 12:20:07 - feat(database): fix database dashboard
// Updated: 2025-12-19 12:20:06 - feat: implement api UI components
// Updated: 2025-12-19 12:19:35 - feat(ui): improve database schema
// Updated: 2025-12-19 12:19:23 - feat(api): enhance UI components
// Updated: 2025-12-19 12:19:12 - style(socket): update authentication in socket
// Updated: 2025-12-19 12:18:59 - perf(validation): fix patient form
// Updated: 2025-12-19 12:18:54 - test: refactor auth database schema
// Updated: 2025-12-19 12:18:39 - chore(ui): enhance authentication in ui
// Updated: 2025-12-19 12:18:19 - refactor: enhance api error handling
// Updated: 2025-12-19 12:18:16 - chore: update api triage system
// Updated: 2025-12-19 12:17:56 - refactor(api): optimize api patient form
// Updated: 2025-12-19 12:17:48 - chore: enhance database patient form
// Updated: 2025-12-19 12:07:36 - chore(api): improve API endpoints (fixes #24)
// Updated: 2025-12-19 12:07:34 - chore: fix database triage system (fixes #35)
// Updated: 2025-12-19 12:07:30 - feat(socket): add socket API endpoints (fixes #49)
// Updated: 2025-12-19 12:07:13 - docs(database): optimize error handling in database
// Updated: 2025-12-19 12:06:36 - chore: implement validation authentication (fixes #22)
// Updated: 2025-12-19 12:06:22 - refactor(api): update api triage system
// Updated: 2025-12-19 12:06:19 - feat(socket): enhance patient form in socket
// Updated: 2025-12-19 12:06:17 - refactor(ui): optimize API endpoints in ui
// Updated: 2025-12-19 12:06:01 - refactor(auth): optimize auth UI components (fixes #19)
// Updated: 2025-12-19 12:05:59 - docs(patient): fix patient authentication
// Updated: 2025-12-19 12:05:58 - perf: fix database triage system (fixes #37)
// Updated: 2025-12-19 12:05:56 - perf(validation): improve validation triage system (fixes #3)
// Updated: 2025-12-19 12:05:46 - fix: implement patient error handling (fixes #28)
// Updated: 2025-12-19 12:05:43 - feat(api): improve triage system (fixes #16)
// Updated: 2025-12-19 12:05:39 - test: optimize patient database schema
// Updated: 2025-12-19 12:05:12 - chore(api): refactor patient form
// Updated: 2025-12-19 12:05:09 - refactor(validation): fix triage system
// Updated: 2025-12-19 12:05:06 - perf(validation): improve UI components
// Updated: 2025-12-19 12:05:04 - refactor(triage): refactor triage authentication
// Updated: 2025-12-19 12:04:54 - docs: implement triage API endpoints
// Updated: 2025-12-19 12:04:53 - fix(auth): enhance dashboard in auth
// Updated: 2025-12-19 12:04:43 - refactor: improve api patient form (fixes #12)
// Updated: 2025-12-19 12:04:39 - feat(api): improve API endpoints
// Updated: 2025-12-19 12:04:25 - docs(api): implement api authentication
// Updated: 2025-12-19 12:04:17 - chore(ui): add API endpoints in ui
// Updated: 2025-12-19 12:04:01 - feat(socket): optimize socket dashboard
// Updated: 2025-12-19 12:03:57 - style: fix api authentication (fixes #31)
// Updated: 2025-12-19 12:03:46 - perf(validation): fix error handling in validation
import React, { useState, useContext, useEffect } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { AuthContext } from '../context/AuthContext';
import { login as loginService } from '../services/authService';
import Loader from '../components/Loader';
import './login.css';

const Login = () => {
  const [formData, setFormData] = useState({
    email: '',
    password: ''
  });
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);
  const [loginError, setLoginError] = useState('');

  const { login } = useContext(AuthContext);
  const navigate = useNavigate();

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));
    
    // Clear field-specific error when user starts typing
    if (errors[name]) {
      setErrors(prev => ({
        ...prev,
        [name]: ''
      }));
    }
    
    // Clear general login error
    if (loginError) {
      setLoginError('');
    }
  };

  const validateForm = () => {
    const newErrors = {};
    
    if (!formData.email) {
      newErrors.email = 'Email is required';
    } else if (!/\S+@\S+\.\S+/.test(formData.email)) {
      newErrors.email = 'Please enter a valid email address';
    }
    
    if (!formData.password) {
      newErrors.password = 'Password is required';
    } else if (formData.password.length < 6) {
      newErrors.password = 'Password must be at least 6 characters long';
    }
    
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    console.log('Login form submitted:', formData);
    setLoginError('');
    
    if (!validateForm()) {
      return;
    }

    setIsLoading(true);
    
    try {
      const result = await login(formData);
      if (result.success) {
        navigate('/dashboard');
      } else {
        setLoginError(result.message || 'Login failed. Please try again.');
      }
    } catch (error) {
      console.error('Login error:', error);
      setLoginError(
        error.response?.data?.message || 
        error.message || 
        'Network error. Please check your connection and try again.'
      );
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="login-page">
      <div className="login-container">
        <div className="login-card">
          <div className="login-header">
            <div className="login-logo">
              <div className="logo-icon">
                <span className="medical-cross">âš•</span>
              </div>
              <h1 className="login-title">EmergenX</h1>
            </div>
            <p className="login-subtitle">Welcome back to your healthcare dashboard</p>
          </div>

          <form onSubmit={handleSubmit} className="login-form" role="form" noValidate>
            <div className="form-group">
              <label htmlFor="email" className="form-label">
                Email Address
              </label>
              <input
                type="email"
                id="email"
                name="email"
                value={formData.email}
                onChange={handleInputChange}
                className={`form-input ${errors.email ? 'form-input-error' : ''}`}
                placeholder="Enter your email"
                aria-describedby={errors.email ? 'email-error' : undefined}
                aria-invalid={!!errors.email}
                autoComplete="email"
                disabled={isLoading}
              />
              {errors.email && (
                <span id="email-error" className="error-message" role="alert">
                  {errors.email}
                </span>
              )}
            </div>

            <div className="form-group">
              <label htmlFor="password" className="form-label">
                Password
              </label>
              <input
                type="password"
                id="password"
                name="password"
                value={formData.password}
                onChange={handleInputChange}
                className={`form-input ${errors.password ? 'form-input-error' : ''}`}
                placeholder="Enter your password"
                aria-describedby={errors.password ? 'password-error' : undefined}
                aria-invalid={!!errors.password}
                autoComplete="current-password"
                disabled={isLoading}
              />
              {errors.password && (
                <span id="password-error" className="error-message" role="alert">
                  {errors.password}
                </span>
              )}
            </div>

            {loginError && (
              <div className="login-error" role="alert">
                <span className="error-icon">âš </span>
                {loginError}
              </div>
            )}

            <button
              type="submit"
              className="login-button"
              disabled={isLoading}
              aria-describedby="login-button-status"
            >
              {isLoading ? (
                <>
                  <Loader />
                  <span>Signing in...</span>
                </>
              ) : (
                <>
                  <span>Login</span>
                  <span className="button-arrow">â†’</span>
                </>
              )}
            </button>

            <div className="login-footer">
              <p className="register-link">
                Don't have an account?{' '}
                <Link to="/register" className="register-link-text">
                  Register here
                </Link>
              </p>
            </div>
          </form>
        </div>
      </div>
    </div>
  );
};

export default Login;






























































































